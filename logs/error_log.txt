[2025-05-27 21:19:00] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 21:19:00] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 21:19:00] AJAX Search Request - User: user_1, Query: 'thinning hair conditioner', Exclude: '', Sort: 'price', Min Rating: '4', Country: 'ca', Filter Cached: false
[2025-05-27 21:19:00] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 21:19:00] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 21:19:00] ps_get_cached_results: Generated user_id = 'user_1' for query 'thinning hair conditioner'
[2025-05-27 21:19:00] ps_get_cached_results: Looking for query_hash = 'c326a3742752c516f76608dd86cde663' with user_id = 'user_1'
[2025-05-27 21:19:00] Initiating live search for: 'thinning hair conditioner' in country: ca
[2025-05-27 21:19:00] Constructed search URL: https://www.amazon.ca/s?k=thinning+hair+conditioner
[2025-05-27 21:19:00] Fetching search results from URL: https://www.amazon.ca/s?k=thinning+hair+conditioner
[2025-05-27 21:19:01] Saved full HTML response to amazon_response_2025-05-27_21-19-01.html
[2025-05-27 21:19:01] Starting to parse Amazon results.
[2025-05-27 21:19:01] XPath: DOMDocument encountered 422 XML parsing errors (showing first 3)
[2025-05-27 21:19:01] XPath XML Error 1: Misplaced DOCTYPE declaration
[2025-05-27 21:19:01] XPath XML Error 2: Unexpected end tag : a
[2025-05-27 21:19:01] XPath XML Error 3: error parsing attribute name
[2025-05-27 21:19:01] XPath: Found 60 product elements using div[@role="listitem"] selector
[2025-05-27 21:19:01] Successfully extracted 56 products using XPath parsing (div[@role="listitem"]).
[2025-05-27 21:19:01] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 21:19:01] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 21:19:01] ps_cache_results: Generated user_id = 'user_1' for query 'thinning hair conditioner'
[2025-05-27 21:19:01] Caching results for user user_1 (query: 'thinning hair conditioner', country: ca): 115.5458984375 KB. Items: 60
[2025-05-27 21:19:01] ps_cache_results: About to insert with user_id = 'user_1', query_hash = 'ec25c1f6fe00623f1fff8ba90835478c'
[2025-05-27 21:19:01] ps_cache_results: Insert result = SUCCESS, wpdb->insert_id = 24
[2025-05-27 21:19:01] Successfully cached results with hash: ec25c1f6fe00623f1fff8ba90835478c, User: user_1
[2025-05-27 21:20:23] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 21:20:23] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 21:20:26] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 21:20:26] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 21:20:26] AJAX Search Request - User: user_1, Query: '', Exclude: '', Sort: 'price', Min Rating: '4', Country: 'us', Filter Cached: true
[2025-05-27 21:25:36] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 21:25:36] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 21:25:38] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 21:25:38] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 21:25:38] AJAX Search Request - User: user_1, Query: '', Exclude: '', Sort: 'price', Min Rating: '4', Country: 'us', Filter Cached: true
[2025-05-27 21:28:12] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 21:28:12] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 21:28:13] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 21:28:13] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 21:28:13] AJAX Search Request - User: user_1, Query: '', Exclude: '', Sort: 'price', Min Rating: '4', Country: 'us', Filter Cached: true
[2025-05-27 21:33:10] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 21:33:10] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 21:33:11] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 21:33:11] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 21:33:11] AJAX Search Request - User: user_1, Query: '', Exclude: '', Sort: 'price', Min Rating: '4', Country: 'us', Filter Cached: true
[2025-05-27 21:33:16] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 21:33:16] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 21:33:17] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 21:33:17] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 21:33:17] AJAX Search Request - User: user_1, Query: '', Exclude: '', Sort: 'price', Min Rating: '4', Country: 'us', Filter Cached: true
[2025-05-27 21:37:57] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 21:37:57] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 21:37:59] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 21:37:59] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 21:37:59] AJAX Search Request - User: user_1, Query: '', Exclude: '', Sort: 'price', Min Rating: '4', Country: 'us', Filter Cached: true
[2025-05-27 21:38:48] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 21:38:48] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 21:38:51] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 21:38:51] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 21:38:51] AJAX Search Request - User: user_1, Query: '', Exclude: '', Sort: 'price', Min Rating: '4', Country: 'us', Filter Cached: true
Testing debug log at Tue May 27 02:40:22 PM PDT 2025
[2025-05-27 21:42:59] [UNIT PRICE DEBUG] Plugin loaded - debug logging system initialized
[2025-05-27 21:43:00] [UNIT PRICE DEBUG] Plugin loaded - debug logging system initialized
[2025-05-27 21:43:00] [UNIT PRICE DEBUG] Plugin loaded - debug logging system initialized
[2025-05-27 21:45:06] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 21:45:06] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 21:45:07] [UNIT PRICE DEBUG] Debug System Test: logToServer function is working | Data: {"timestamp":"2025-05-27T21:45:07.023Z","testMessage":"This is a test to verify debug logging is functional"}
[2025-05-27 21:45:07] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 21:45:07] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 21:45:07] AJAX Search Request - User: user_1, Query: '', Exclude: '', Sort: 'price', Min Rating: '4', Country: 'us', Filter Cached: true
[2025-05-27 21:45:07] [UNIT PRICE DEBUG] Load Cached Results: Request parameters | Data: {"sortBy":"price","country":"us"}
[2025-05-27 21:45:07] [UNIT PRICE DEBUG] Page Load: Document ready fired, initializing unit price sorting system | Data: {"hasAjaxUrl":true,"hasNonce":true,"userAgent":"Mozilla\/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/136.0.0.0 Sa"}
[2025-05-27 21:45:07] [UNIT PRICE DEBUG] Load Cached Results: Starting to load cached results on page refresh
[2025-05-27 21:45:07] [UNIT PRICE DEBUG] Set Default Sorting Analysis | Data: {"currentSortValue":"price","shouldDefaultToUnitPrice":false,"willChangeSorting":false}
[2025-05-27 21:45:07] [UNIT PRICE DEBUG] Unit Price Analysis on Page Refresh | Data: {"totalItems":60,"itemsWithUnitPrice":10,"percentage":17,"shouldDefaultToUnitPrice":false,"sampleItems":[{"index":0,"title":"Nexxus Unbreakable Care\u2122 Thickening Conditioner fo...","price":"$17.23","price_value":17.23,"price_per_unit":"$4.31\/100 ml","unit":"100 ml","price_per_unit_value":4.311,"hasUnitPrice":true},{"index":1,"title":"PURA D&#x27;OR Biotin Original Gold Label Anti-Thi...","price":"$56.99","price_value":56.99,"price_per_unit":"$6.02","unit":"No unit","price_per_unit_value":6.02,"hasUnitPrice":""},{"index":2,"title":"Luseta Rosemary Shampoo and Conditioner Nourishes ...","price":"$45.99","price_value":45.99,"price_per_unit":"$9.20","unit":"No unit","price_per_unit_value":9.2,"hasUnitPrice":""},{"index":3,"title":"NORMADENSE 1 Vegan Biotin Conditioner, Strengtheni...","price":"$24.99","price_value":24.99,"price_per_unit":"$8.33\/100 ml","unit":"100 ml","price_per_unit_value":8.331,"hasUnitPrice":true},{"index":4,"title":"Majestic Pure Biotin Conditioner for Hair - Thicke...","price":"$16.99","price_value":16.99,"price_per_unit":"$3.59","unit":"No unit","price_per_unit_value":3.59,"hasUnitPrice":""},{"index":5,"title":"Nioxin Scalp + Hair Thickening System 2 Conditione...","price":"$32.98","price_value":32.98,"price_per_unit":"$6.60","unit":"No unit","price_per_unit_value":6.6,"hasUnitPrice":""},{"index":6,"title":"HAIR BIOLOGY VOLUME RINSE-OFF CONDITIONER 380 ML...","price":"$14.97","price_value":14.97,"price_per_unit":"$3.94","unit":"No unit","price_per_unit_value":3.94,"hasUnitPrice":""},{"index":7,"title":"EverPure Sulfate-Free Anti-Breakage, Thickening, V...","price":"$19.27","price_value":19.27,"price_per_unit":"$7.71","unit":"No unit","price_per_unit_value":7.71,"hasUnitPrice":""},{"index":8,"title":"Rice Water Shampoo and Conditioner, Packed with Bi...","price":"$39.99","price_value":39.99,"price_per_unit":"$16.66","unit":"No unit","price_per_unit_value":16.66,"hasUnitPrice":""},{"index":9,"title":"Viviscal Gorgeous Growth Densifying Conditioner 25...","price":"$17.43","price_value":17.43,"price_per_unit":"$6.97","unit":"No unit","price_per_unit_value":6.97,"hasUnitPrice":""}]}
[2025-05-27 21:45:07] [UNIT PRICE DEBUG] Load Cached Results: Received response | Data: {"success":true,"productCount":60,"hasResponseData":true,"hasItems":true}
[2025-05-27 21:45:07] [UNIT PRICE DEBUG] Load Cached Results: Successfully processed and rendered products | Data: {"originalCount":60,"filteredCount":13,"finalCount":13,"sortingChanged":false,"currentSortBy":"price"}
[2025-05-27 22:17:26] ps_get_user_identifier: User not logged in or wp_user_id is 0, checking for visitor cookie
[2025-05-27 22:17:26] ps_get_user_identifier: Found existing cookie: 'visitor_8392260647'
[2025-05-27 22:17:26] ps_get_user_identifier: Cookie is valid, returning: 'visitor_8392260647'
[2025-05-27 22:17:27] ps_get_user_identifier: User not logged in or wp_user_id is 0, checking for visitor cookie
[2025-05-27 22:17:27] ps_get_user_identifier: Found existing cookie: 'visitor_8392260647'
[2025-05-27 22:17:27] ps_get_user_identifier: Cookie is valid, returning: 'visitor_8392260647'
[2025-05-27 22:17:27] AJAX Search Request - User: visitor_8392260647, Query: '', Exclude: '', Sort: 'price', Min Rating: '4', Country: 'ca', Filter Cached: true
[2025-05-27 22:17:27] [UNIT PRICE DEBUG] Page Load: Document ready fired, initializing unit price sorting system | Data: {"hasAjaxUrl":true,"hasNonce":true,"userAgent":"Mozilla\/5.0 (Linux; Android 10; K) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/136.0.0.0 Mobile Sa"}
[2025-05-27 22:17:27] [UNIT PRICE DEBUG] Load Cached Results: Request parameters | Data: {"sortBy":"price","country":"ca"}
[2025-05-27 22:17:27] [UNIT PRICE DEBUG] Load Cached Results: Starting to load cached results on page refresh
[2025-05-27 22:17:27] [UNIT PRICE DEBUG] Debug System Test: logToServer function is working | Data: {"timestamp":"2025-05-27T22:17:28.072Z","testMessage":"This is a test to verify debug logging is functional"}
[2025-05-27 22:17:27] [UNIT PRICE DEBUG] Load Cached Results: Received response | Data: {"success":true,"productCount":60,"hasResponseData":true,"hasItems":true}
[2025-05-27 22:17:27] [UNIT PRICE DEBUG] Apply Saved Default Sorting: No sort element or saved preference | Data: {"hasSortElement":true,"savedDefaultSort":null}
[2025-05-27 22:17:27] [UNIT PRICE DEBUG] Load Cached Results: Successfully processed and rendered products | Data: {"originalCount":60,"filteredCount":16,"finalCount":16,"sortingChanged":false,"currentSortBy":"price"}
[2025-05-27 22:18:46] ps_get_user_identifier: User not logged in or wp_user_id is 0, checking for visitor cookie
[2025-05-27 22:18:46] ps_get_user_identifier: Found existing cookie: 'visitor_8392260647'
[2025-05-27 22:18:46] ps_get_user_identifier: Cookie is valid, returning: 'visitor_8392260647'
[2025-05-27 22:18:46] AJAX Search Request - User: visitor_8392260647, Query: 'Thinning conditioner', Exclude: '', Sort: 'price', Min Rating: '4', Country: 'ca', Filter Cached: false
[2025-05-27 22:18:46] ps_get_user_identifier: User not logged in or wp_user_id is 0, checking for visitor cookie
[2025-05-27 22:18:46] ps_get_user_identifier: Found existing cookie: 'visitor_8392260647'
[2025-05-27 22:18:46] ps_get_user_identifier: Cookie is valid, returning: 'visitor_8392260647'
[2025-05-27 22:18:46] ps_get_cached_results: Generated user_id = 'visitor_8392260647' for query 'Thinning conditioner'
[2025-05-27 22:18:46] ps_get_cached_results: Looking for query_hash = '73f08d72fc0c28b110d83671f82fde6a' with user_id = 'visitor_8392260647'
[2025-05-27 22:18:46] Initiating live search for: 'Thinning conditioner' in country: ca
[2025-05-27 22:18:46] Constructed search URL: https://www.amazon.ca/s?k=Thinning+conditioner
[2025-05-27 22:18:46] Fetching search results from URL: https://www.amazon.ca/s?k=Thinning+conditioner
[2025-05-27 22:18:47] Saved full HTML response to amazon_response_2025-05-27_22-18-47.html
[2025-05-27 22:18:47] Starting to parse Amazon results.
[2025-05-27 22:18:47] XPath: DOMDocument encountered 416 XML parsing errors (showing first 3)
[2025-05-27 22:18:47] XPath XML Error 1: Misplaced DOCTYPE declaration
[2025-05-27 22:18:47] XPath XML Error 2: Unexpected end tag : a
[2025-05-27 22:18:47] XPath XML Error 3: error parsing attribute name
[2025-05-27 22:18:47] XPath: Found 60 product elements using div[@role="listitem"] selector
[2025-05-27 22:18:47] Successfully extracted 58 products using XPath parsing (div[@role="listitem"]).
[2025-05-27 22:18:47] ps_get_user_identifier: User not logged in or wp_user_id is 0, checking for visitor cookie
[2025-05-27 22:18:47] ps_get_user_identifier: Found existing cookie: 'visitor_8392260647'
[2025-05-27 22:18:47] ps_get_user_identifier: Cookie is valid, returning: 'visitor_8392260647'
[2025-05-27 22:18:47] ps_cache_results: Generated user_id = 'visitor_8392260647' for query 'Thinning conditioner'
[2025-05-27 22:18:47] Caching results for user visitor_8392260647 (query: 'Thinning conditioner', country: ca): 113.8310546875 KB. Items: 60
[2025-05-27 22:18:47] ps_cache_results: About to insert with user_id = 'visitor_8392260647', query_hash = 'fccc72d7ccd041b46840d0e9357c7844'
[2025-05-27 22:18:47] ps_cache_results: Insert result = SUCCESS, wpdb->insert_id = 25
[2025-05-27 22:18:47] Successfully cached results with hash: fccc72d7ccd041b46840d0e9357c7844, User: visitor_8392260647
[2025-05-27 22:18:48] [UNIT PRICE DEBUG] Calculate and Save Default Sorting | Data: {"currentSortValue":"price","shouldDefaultToUnitPrice":false,"savedDefaultSort":"price","willChangeSorting":false}
[2025-05-27 22:18:48] [UNIT PRICE DEBUG] Unit Price Analysis After Live Search | Data: {"totalItems":58,"itemsWithUnitPrice":11,"percentage":19,"shouldDefaultToUnitPrice":false,"sampleItems":[{"index":0,"title":"HAIR BIOLOGY VOLUME 1 IN 1 SHAMPOO 380 ML...","price":"$14.97","price_value":14.97,"price_per_unit":"$3.94","unit":"No unit","price_per_unit_value":3.94,"hasUnitPrice":""},{"index":1,"title":"SEEN Conditioner, Fragrance Free - Non-Comedogenic...","price":"$39.00","price_value":39,"price_per_unit":"$15.33","unit":"No unit","price_per_unit_value":15.33,"hasUnitPrice":""},{"index":2,"title":"HAIR BIOLOGY SHAMPOO SILVER 1 IN 1 SHAMPOO 380 ML...","price":"$14.97","price_value":14.97,"price_per_unit":"$3.94","unit":"No unit","price_per_unit_value":3.94,"hasUnitPrice":""},{"index":3,"title":"PURA D&#x27;OR Biotin Original Gold Label Anti-Thi...","price":"$56.99","price_value":56.99,"price_per_unit":"$6.02","unit":"No unit","price_per_unit_value":6.02,"hasUnitPrice":""},{"index":4,"title":"Majestic Pure Biotin Conditioner for Hair - Thicke...","price":"$16.99","price_value":16.99,"price_per_unit":"$3.59","unit":"No unit","price_per_unit_value":3.59,"hasUnitPrice":""},{"index":5,"title":"HAIR BIOLOGY VOLUME RINSE-OFF CONDITIONER 380 ML...","price":"$14.97","price_value":14.97,"price_per_unit":"$3.94","unit":"No unit","price_per_unit_value":3.94,"hasUnitPrice":""},{"index":6,"title":"Nioxin Scalp + Hair Thickening System 2 Conditione...","price":"$32.98","price_value":32.98,"price_per_unit":"$6.60","unit":"No unit","price_per_unit_value":6.6,"hasUnitPrice":""},{"index":7,"title":"Nioxin System 4 Scalp + Hair Thickening Conditione...","price":"$32.99","price_value":32.99,"price_per_unit":"$6.60","unit":"No unit","price_per_unit_value":6.6,"hasUnitPrice":""},{"index":8,"title":"Rice Water Shampoo and Conditioner, Packed with Bi...","price":"$39.99","price_value":39.99,"price_per_unit":"$16.66","unit":"No unit","price_per_unit_value":16.66,"hasUnitPrice":""},{"index":9,"title":"Biotin Shampoo and Conditioner for Women and Men -...","price":"$32.99","price_value":32.99,"price_per_unit":"$3.49","unit":"No unit","price_per_unit_value":3.49,"hasUnitPrice":""}]}
[2025-05-27 22:19:22] ps_get_user_identifier: User not logged in or wp_user_id is 0, checking for visitor cookie
[2025-05-27 22:19:22] ps_get_user_identifier: Found existing cookie: 'visitor_8392260647'
[2025-05-27 22:19:22] ps_get_user_identifier: Cookie is valid, returning: 'visitor_8392260647'
[2025-05-27 22:19:22] [UNIT PRICE DEBUG] Load Cached Results: Starting to load cached results on page refresh
[2025-05-27 22:19:22] [UNIT PRICE DEBUG] Load Cached Results: Request parameters | Data: {"sortBy":"price","country":"ca"}
[2025-05-27 22:19:22] ps_get_user_identifier: User not logged in or wp_user_id is 0, checking for visitor cookie
[2025-05-27 22:19:22] ps_get_user_identifier: Found existing cookie: 'visitor_8392260647'
[2025-05-27 22:19:22] ps_get_user_identifier: Cookie is valid, returning: 'visitor_8392260647'
[2025-05-27 22:19:22] AJAX Search Request - User: visitor_8392260647, Query: '', Exclude: '', Sort: 'price', Min Rating: '4', Country: 'ca', Filter Cached: true
[2025-05-27 22:19:22] [UNIT PRICE DEBUG] Debug System Test: logToServer function is working | Data: {"timestamp":"2025-05-27T22:19:23.670Z","testMessage":"This is a test to verify debug logging is functional"}
[2025-05-27 22:19:22] [UNIT PRICE DEBUG] Page Load: Document ready fired, initializing unit price sorting system | Data: {"hasAjaxUrl":true,"hasNonce":true,"userAgent":"Mozilla\/5.0 (Linux; Android 10; K) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/136.0.0.0 Mobile Sa"}
[2025-05-27 22:19:22] [UNIT PRICE DEBUG] Load Cached Results: Received response | Data: {"success":true,"productCount":60,"hasResponseData":true,"hasItems":true}
[2025-05-27 22:19:22] [UNIT PRICE DEBUG] Apply Saved Default Sorting: No sort element or saved preference | Data: {"hasSortElement":true,"savedDefaultSort":null}
[2025-05-27 22:19:22] [UNIT PRICE DEBUG] Load Cached Results: Successfully processed and rendered products | Data: {"originalCount":60,"filteredCount":17,"finalCount":17,"sortingChanged":false,"currentSortBy":"price"}
[2025-05-27 22:24:48] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 22:24:48] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 22:24:50] [UNIT PRICE DEBUG] Load Cached Results: Request parameters | Data: {"sortBy":"price","country":"us"}
[2025-05-27 22:24:50] [UNIT PRICE DEBUG] Debug System Test: logToServer function is working | Data: {"timestamp":"2025-05-27T22:24:49.960Z","testMessage":"This is a test to verify debug logging is functional"}
[2025-05-27 22:24:50] [UNIT PRICE DEBUG] Page Load: Document ready fired, initializing unit price sorting system | Data: {"hasAjaxUrl":true,"hasNonce":true,"userAgent":"Mozilla\/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/136.0.0.0 Sa"}
[2025-05-27 22:24:50] [UNIT PRICE DEBUG] Load Cached Results: Starting to load cached results on page refresh
[2025-05-27 22:24:50] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 22:24:50] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 22:24:50] AJAX Search Request - User: user_1, Query: '', Exclude: '', Sort: 'price', Min Rating: '4', Country: 'us', Filter Cached: true
[2025-05-27 22:24:50] [UNIT PRICE DEBUG] Load Cached Results: Received response | Data: {"success":true,"productCount":60,"hasResponseData":true,"hasItems":true}
[2025-05-27 22:24:50] [UNIT PRICE DEBUG] Apply Saved Default Sorting: No saved preference found | Data: {"hasSortElement":true,"savedDefaultSort":null}
[2025-05-27 22:24:50] [UNIT PRICE DEBUG] Load Cached Results: Successfully processed and rendered products | Data: {"originalCount":60,"filteredCount":13,"finalCount":13,"sortingChanged":false,"currentSortBy":"price"}
[2025-05-27 22:24:57] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 22:24:57] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 22:24:57] AJAX Search Request - User: user_1, Query: 'thinning hair conditioner', Exclude: '', Sort: 'price', Min Rating: '4', Country: 'ca', Filter Cached: false
[2025-05-27 22:24:57] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 22:24:57] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 22:24:57] ps_get_cached_results: Generated user_id = 'user_1' for query 'thinning hair conditioner'
[2025-05-27 22:24:57] ps_get_cached_results: Looking for query_hash = 'c326a3742752c516f76608dd86cde663' with user_id = 'user_1'
[2025-05-27 22:24:57] Initiating live search for: 'thinning hair conditioner' in country: ca
[2025-05-27 22:24:57] Constructed search URL: https://www.amazon.ca/s?k=thinning+hair+conditioner
[2025-05-27 22:24:57] Fetching search results from URL: https://www.amazon.ca/s?k=thinning+hair+conditioner
[2025-05-27 22:24:58] Saved full HTML response to amazon_response_2025-05-27_22-24-58.html
[2025-05-27 22:24:58] Starting to parse Amazon results.
[2025-05-27 22:24:58] XPath: DOMDocument encountered 402 XML parsing errors (showing first 3)
[2025-05-27 22:24:58] XPath XML Error 1: Misplaced DOCTYPE declaration
[2025-05-27 22:24:58] XPath XML Error 2: Unexpected end tag : a
[2025-05-27 22:24:58] XPath XML Error 3: error parsing attribute name
[2025-05-27 22:24:58] XPath: Found 60 product elements using div[@role="listitem"] selector
[2025-05-27 22:24:58] Successfully extracted 58 products using XPath parsing (div[@role="listitem"]).
[2025-05-27 22:24:58] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 22:24:58] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 22:24:58] ps_cache_results: Generated user_id = 'user_1' for query 'thinning hair conditioner'
[2025-05-27 22:24:58] Caching results for user user_1 (query: 'thinning hair conditioner', country: ca): 114.4326171875 KB. Items: 60
[2025-05-27 22:24:58] ps_cache_results: About to insert with user_id = 'user_1', query_hash = 'ec25c1f6fe00623f1fff8ba90835478c'
[2025-05-27 22:24:58] ps_cache_results: Insert result = SUCCESS, wpdb->insert_id = 26
[2025-05-27 22:24:58] Successfully cached results with hash: ec25c1f6fe00623f1fff8ba90835478c, User: user_1
[2025-05-27 22:24:58] [UNIT PRICE DEBUG] Unit Price Analysis After Live Search | Data: {"totalItems":58,"itemsWithUnitPrice":57,"percentage":98,"shouldDefaultToUnitPrice":true,"sampleItems":[{"index":0,"title":"HAIR BIOLOGY VOLUME 1 IN 1 SHAMPOO 380 ML...","price":"$14.97","price_value":14.97,"price_per_unit":"$3.94","unit":"No unit","price_per_unit_value":3.94,"hasUnitPrice":true},{"index":1,"title":"PURA D&#x27;OR Biotin Original Gold Label Anti-Thi...","price":"$56.99","price_value":56.99,"price_per_unit":"$6.02","unit":"No unit","price_per_unit_value":6.02,"hasUnitPrice":true},{"index":2,"title":"SEEN Conditioner, Fragrance Free - Non-Comedogenic...","price":"$39.00","price_value":39,"price_per_unit":"$15.33","unit":"No unit","price_per_unit_value":15.33,"hasUnitPrice":true},{"index":3,"title":"Biolage ColorLast Conditioner | Helps Maintain Col...","price":"$51.00","price_value":51,"price_per_unit":"$5.10","unit":"No unit","price_per_unit_value":5.1,"hasUnitPrice":true},{"index":4,"title":"Majestic Pure Biotin Conditioner for Hair - Thicke...","price":"$16.99","price_value":16.99,"price_per_unit":"$3.59","unit":"No unit","price_per_unit_value":3.59,"hasUnitPrice":true},{"index":5,"title":"Nioxin Scalp + Hair Thickening System 2 Conditione...","price":"$32.98","price_value":32.98,"price_per_unit":"$6.60","unit":"No unit","price_per_unit_value":6.6,"hasUnitPrice":true},{"index":6,"title":"HAIR BIOLOGY VOLUME RINSE-OFF CONDITIONER 380 ML...","price":"$14.97","price_value":14.97,"price_per_unit":"$3.94","unit":"No unit","price_per_unit_value":3.94,"hasUnitPrice":true},{"index":7,"title":"EverPure Sulfate-Free Anti-Breakage, Thickening, V...","price":"$19.27","price_value":19.27,"price_per_unit":"$7.71","unit":"No unit","price_per_unit_value":7.71,"hasUnitPrice":true},{"index":8,"title":"Viviscal Gorgeous Growth Densifying Conditioner 25...","price":"$17.43","price_value":17.43,"price_per_unit":"$6.97","unit":"No unit","price_per_unit_value":6.97,"hasUnitPrice":true},{"index":9,"title":"Rice Water Shampoo and Conditioner, Packed with Bi...","price":"$39.99","price_value":39.99,"price_per_unit":"$16.66","unit":"No unit","price_per_unit_value":16.66,"hasUnitPrice":true}]}
[2025-05-27 22:24:58] [UNIT PRICE DEBUG] Unit Price Sorting: Automatically switched to unit price sorting | Data: {"previousValue":"price","newValue":"price_per_unit","itemCount":58}
[2025-05-27 22:24:58] [UNIT PRICE DEBUG] Calculate and Save Default Sorting | Data: {"currentSortValue":"price","shouldDefaultToUnitPrice":true,"savedDefaultSort":"price_per_unit","willChangeSorting":true}
[2025-05-27 22:58:04] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 22:58:04] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 22:58:08] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 22:58:08] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 22:58:08] AJAX Search Request - User: user_1, Query: '', Exclude: '', Sort: 'price', Min Rating: '4', Country: 'us', Filter Cached: true
[2025-05-27 22:58:08] [UNIT PRICE DEBUG] Page Load: Document ready fired, initializing unit price sorting system | Data: {"hasAjaxUrl":true,"hasNonce":true,"userAgent":"Mozilla\/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/136.0.0.0 Sa"}
[2025-05-27 22:58:08] [UNIT PRICE DEBUG] Load Cached Results: Starting to load cached results on page refresh
[2025-05-27 22:58:08] [UNIT PRICE DEBUG] Debug System Test: logToServer function is working | Data: {"timestamp":"2025-05-27T22:58:06.387Z","testMessage":"This is a test to verify debug logging is functional"}
[2025-05-27 22:58:08] [UNIT PRICE DEBUG] Load Cached Results: Request parameters | Data: {"sortBy":"price","country":"us"}
[2025-05-27 22:58:11] [UNIT PRICE DEBUG] Unit Price Sorting: Applied saved unit price sorting preference | Data: {"previousValue":"price","newValue":"price_per_unit"}
[2025-05-27 22:58:11] [UNIT PRICE DEBUG] Load Cached Results: Received response | Data: {"success":true,"productCount":60,"hasResponseData":true,"hasItems":true}
[2025-05-27 22:58:11] [UNIT PRICE DEBUG] Apply Saved Default Sorting | Data: {"currentSortValue":"price","savedDefaultSort":"price_per_unit","willChangeSorting":true}
[2025-05-27 22:58:11] [UNIT PRICE DEBUG] Load Cached Results: Successfully processed and rendered products | Data: {"originalCount":60,"filteredCount":15,"finalCount":15,"sortingChanged":true,"currentSortBy":"price_per_unit"}
[2025-05-27 22:58:21] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 22:58:21] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 22:58:21] AJAX Search Request - User: user_1, Query: 'thinning hair conditioner', Exclude: '', Sort: 'price_per_unit', Min Rating: '4', Country: 'ca', Filter Cached: false
[2025-05-27 22:58:21] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 22:58:21] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 22:58:21] ps_get_cached_results: Generated user_id = 'user_1' for query 'thinning hair conditioner'
[2025-05-27 22:58:21] ps_get_cached_results: Looking for query_hash = '6d823240be630f944197e5cfbccdf152' with user_id = 'user_1'
[2025-05-27 22:58:21] Initiating live search for: 'thinning hair conditioner' in country: ca
[2025-05-27 22:58:21] Constructed search URL: https://www.amazon.ca/s?k=thinning+hair+conditioner
[2025-05-27 22:58:21] Fetching search results from URL: https://www.amazon.ca/s?k=thinning+hair+conditioner
[2025-05-27 22:58:22] Saved full HTML response to amazon_response_2025-05-27_22-58-22.html
[2025-05-27 22:58:22] Starting to parse Amazon results.
[2025-05-27 22:58:22] XPath: DOMDocument encountered 425 XML parsing errors (showing first 3)
[2025-05-27 22:58:22] XPath XML Error 1: Misplaced DOCTYPE declaration
[2025-05-27 22:58:22] XPath XML Error 2: Unexpected end tag : a
[2025-05-27 22:58:22] XPath XML Error 3: error parsing attribute name
[2025-05-27 22:58:22] XPath: Found 60 product elements using div[@role="listitem"] selector
[2025-05-27 22:58:22] Successfully extracted 58 products using XPath parsing (div[@role="listitem"]).
[2025-05-27 22:58:22] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 22:58:22] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 22:58:22] ps_cache_results: Generated user_id = 'user_1' for query 'thinning hair conditioner'
[2025-05-27 22:58:22] Caching results for user user_1 (query: 'thinning hair conditioner', country: ca): 114.771484375 KB. Items: 60
[2025-05-27 22:58:22] ps_cache_results: About to insert with user_id = 'user_1', query_hash = 'ec25c1f6fe00623f1fff8ba90835478c'
[2025-05-27 22:58:22] ps_cache_results: Insert result = SUCCESS, wpdb->insert_id = 27
[2025-05-27 22:58:22] Successfully cached results with hash: ec25c1f6fe00623f1fff8ba90835478c, User: user_1
[2025-05-27 22:58:22] [UNIT PRICE DEBUG] Calculate and Save Default Sorting | Data: {"currentSortValue":"price_per_unit","shouldDefaultToUnitPrice":true,"savedDefaultSort":"price_per_unit","willChangeSorting":false}
[2025-05-27 22:58:22] [UNIT PRICE DEBUG] Unit Price Analysis After Live Search | Data: {"totalItems":58,"itemsWithUnitPrice":57,"percentage":98,"shouldDefaultToUnitPrice":true,"sampleItems":[{"index":0,"title":"HAIR BIOLOGY VOLUME 1 IN 1 SHAMPOO 380 ML...","price":"$14.97","price_value":14.97,"price_per_unit":"$3.94","unit":"No unit","price_per_unit_value":3.94,"hasUnitPrice":true},{"index":1,"title":"PURA D&#x27;OR Biotin Original Gold Label Anti-Thi...","price":"$56.99","price_value":56.99,"price_per_unit":"$6.02","unit":"No unit","price_per_unit_value":6.02,"hasUnitPrice":true},{"index":2,"title":"SEEN Conditioner, Fragrance Free - Non-Comedogenic...","price":"$39.00","price_value":39,"price_per_unit":"$15.33","unit":"No unit","price_per_unit_value":15.33,"hasUnitPrice":true},{"index":3,"title":"Biolage ColorLast Conditioner | Helps Maintain Col...","price":"$51.00","price_value":51,"price_per_unit":"$5.10","unit":"No unit","price_per_unit_value":5.1,"hasUnitPrice":true},{"index":4,"title":"Majestic Pure Biotin Conditioner for Hair - Thicke...","price":"$16.99","price_value":16.99,"price_per_unit":"$3.59","unit":"No unit","price_per_unit_value":3.59,"hasUnitPrice":true},{"index":5,"title":"Nioxin Scalp + Hair Thickening System 2 Conditione...","price":"$32.98","price_value":32.98,"price_per_unit":"$6.60","unit":"No unit","price_per_unit_value":6.6,"hasUnitPrice":true},{"index":6,"title":"HAIR BIOLOGY VOLUME RINSE-OFF CONDITIONER 380 ML...","price":"$14.97","price_value":14.97,"price_per_unit":"$3.94","unit":"No unit","price_per_unit_value":3.94,"hasUnitPrice":true},{"index":7,"title":"EverPure Sulfate-Free Anti-Breakage, Thickening, V...","price":"$19.27","price_value":19.27,"price_per_unit":"$7.71","unit":"No unit","price_per_unit_value":7.71,"hasUnitPrice":true},{"index":8,"title":"Viviscal Gorgeous Growth Densifying Conditioner 25...","price":"$17.43","price_value":17.43,"price_per_unit":"$6.97","unit":"No unit","price_per_unit_value":6.97,"hasUnitPrice":true},{"index":9,"title":"Rice Water Shampoo and Conditioner, Packed with Bi...","price":"$39.99","price_value":39.99,"price_per_unit":"$16.66","unit":"No unit","price_per_unit_value":16.66,"hasUnitPrice":true}]}
[2025-05-27 23:13:57] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 23:13:57] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 23:13:58] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 23:13:58] [UNIT PRICE DEBUG] Page Load: Document ready fired, initializing unit price sorting system | Data: {"hasAjaxUrl":true,"hasNonce":true,"userAgent":"Mozilla\/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/136.0.0.0 Sa"}
[2025-05-27 23:13:58] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 23:13:58] AJAX Search Request - User: user_1, Query: '', Exclude: '', Sort: 'price', Min Rating: '4', Country: 'us', Filter Cached: true
[2025-05-27 23:13:58] [UNIT PRICE DEBUG] Load Cached Results: Starting to load cached results on page refresh
[2025-05-27 23:13:58] [UNIT PRICE DEBUG] Debug System Test: logToServer function is working | Data: {"timestamp":"2025-05-27T23:13:58.310Z","testMessage":"This is a test to verify debug logging is functional"}
[2025-05-27 23:13:58] [UNIT PRICE DEBUG] Load Cached Results: Request parameters | Data: {"sortBy":"price","country":"us"}
[2025-05-27 23:13:59] [UNIT PRICE DEBUG] Apply Saved Default Sorting | Data: {"currentSortValue":"price_per_unit","savedDefaultSort":"price_per_unit","willChangeSorting":false}
[2025-05-27 23:13:59] [UNIT PRICE DEBUG] Load Cached Results: Received response | Data: {"success":true,"productCount":60,"hasResponseData":true,"hasItems":true}
[2025-05-27 23:13:59] [UNIT PRICE DEBUG] Load Cached Results: Successfully processed and rendered products | Data: {"originalCount":60,"filteredCount":12,"finalCount":12,"sortingChanged":false,"currentSortBy":"price_per_unit"}
[2025-05-27 23:14:01] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 23:14:01] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 23:14:02] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 23:14:02] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 23:14:02] AJAX Search Request - User: user_1, Query: '', Exclude: '', Sort: 'price', Min Rating: '4', Country: 'us', Filter Cached: true
[2025-05-27 23:14:02] [UNIT PRICE DEBUG] Load Cached Results: Starting to load cached results on page refresh
[2025-05-27 23:14:02] [UNIT PRICE DEBUG] Page Load: Document ready fired, initializing unit price sorting system | Data: {"hasAjaxUrl":true,"hasNonce":true,"userAgent":"Mozilla\/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/136.0.0.0 Sa"}
[2025-05-27 23:14:02] [UNIT PRICE DEBUG] Debug System Test: logToServer function is working | Data: {"timestamp":"2025-05-27T23:14:02.243Z","testMessage":"This is a test to verify debug logging is functional"}
[2025-05-27 23:14:02] [UNIT PRICE DEBUG] Load Cached Results: Request parameters | Data: {"sortBy":"price","country":"us"}
[2025-05-27 23:14:02] [UNIT PRICE DEBUG] Load Cached Results: Received response | Data: {"success":true,"productCount":60,"hasResponseData":true,"hasItems":true}
[2025-05-27 23:14:02] [UNIT PRICE DEBUG] Apply Saved Default Sorting | Data: {"currentSortValue":"price","savedDefaultSort":"price_per_unit","willChangeSorting":true}
[2025-05-27 23:14:02] [UNIT PRICE DEBUG] Unit Price Sorting: Applied saved unit price sorting preference | Data: {"previousValue":"price","newValue":"price_per_unit"}
[2025-05-27 23:14:02] [UNIT PRICE DEBUG] Load Cached Results: Successfully processed and rendered products | Data: {"originalCount":60,"filteredCount":12,"finalCount":12,"sortingChanged":true,"currentSortBy":"price_per_unit"}
[2025-05-27 23:19:09] ps_get_user_identifier: User not logged in or wp_user_id is 0, checking for visitor cookie
[2025-05-27 23:19:09] ps_get_user_identifier: No existing cookie found
[2025-05-27 23:19:09] ps_get_user_identifier: Creating new visitor ID: 'visitor_97505a98f0'
[2025-05-27 23:19:09] ps_get_user_identifier: Cookie set, returning: 'visitor_97505a98f0'
[2025-05-27 23:21:57] [UNIT PRICE DEBUG] Page Load: Document ready fired, initializing unit price sorting system | Data: {"hasAjaxUrl":true,"hasNonce":true,"userAgent":"Mozilla\/5.0 (Linux; Android 10; K) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/136.0.0.0 Mobile Sa"}
[2025-05-27 23:38:07] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 23:38:07] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 23:38:08] [UNIT PRICE DEBUG] Load Cached Results: Request parameters | Data: {"sortBy":"price","country":"us"}
[2025-05-27 23:38:08] [UNIT PRICE DEBUG] Page Load: Document ready fired, initializing unit price sorting system | Data: {"hasAjaxUrl":true,"hasNonce":true,"userAgent":"Mozilla\/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/136.0.0.0 Sa"}
[2025-05-27 23:38:08] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 23:38:08] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 23:38:08] AJAX Search Request - User: user_1, Query: '', Exclude: '', Sort: 'price', Min Rating: '4', Country: 'us', Filter Cached: true
[2025-05-27 23:38:08] [UNIT PRICE DEBUG] Load Cached Results: Starting to load cached results on page refresh
[2025-05-27 23:38:08] [UNIT PRICE DEBUG] Debug System Test: logToServer function is working | Data: {"timestamp":"2025-05-27T23:38:08.159Z","testMessage":"This is a test to verify debug logging is functional"}
[2025-05-27 23:38:08] [UNIT PRICE DEBUG] Apply Saved Default Sorting | Data: {"currentSortValue":"price","savedDefaultSort":"price_per_unit","willChangeSorting":true}
[2025-05-27 23:38:08] [UNIT PRICE DEBUG] Load Cached Results: Received response | Data: {"success":true,"productCount":60,"hasResponseData":true,"hasItems":true}
[2025-05-27 23:38:08] [UNIT PRICE DEBUG] Unit Price Sorting: Applied saved unit price sorting preference | Data: {"previousValue":"price","newValue":"price_per_unit"}
[2025-05-27 23:38:08] [UNIT PRICE DEBUG] Load Cached Results: Successfully processed and rendered products | Data: {"originalCount":60,"filteredCount":12,"finalCount":12,"sortingChanged":true,"currentSortBy":"price_per_unit"}
[2025-05-27 23:39:02] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 23:39:02] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 23:39:02] AJAX Search Request - User: user_1, Query: 'thinning hair conditioner', Exclude: '', Sort: 'price_per_unit', Min Rating: '4', Country: 'ca', Filter Cached: false
[2025-05-27 23:39:02] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 23:39:02] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 23:39:02] ps_get_cached_results: Generated user_id = 'user_1' for query 'thinning hair conditioner'
[2025-05-27 23:39:02] ps_get_cached_results: Looking for query_hash = '6d823240be630f944197e5cfbccdf152' with user_id = 'user_1'
[2025-05-27 23:39:02] Initiating live search for: 'thinning hair conditioner' in country: ca
[2025-05-27 23:39:02] Constructed search URL: https://www.amazon.ca/s?k=thinning+hair+conditioner
[2025-05-27 23:39:02] Fetching search results from URL: https://www.amazon.ca/s?k=thinning+hair+conditioner
[2025-05-27 23:39:04] Saved full HTML response to amazon_response_2025-05-27_23-39-04.html
[2025-05-27 23:39:04] Starting to parse Amazon results.
[2025-05-27 23:39:04] XPath: DOMDocument encountered 428 XML parsing errors (showing first 3)
[2025-05-27 23:39:04] XPath XML Error 1: Misplaced DOCTYPE declaration
[2025-05-27 23:39:04] XPath XML Error 2: Unexpected end tag : a
[2025-05-27 23:39:04] XPath XML Error 3: error parsing attribute name
[2025-05-27 23:39:04] XPath: Found 60 product elements using div[@role="listitem"] selector
[2025-05-27 23:39:04] Unit price reasonableness check failed (alt): Product price , Unit price $5,400.00/100 ml (ratio: 100.00). Marking as invalid.
[2025-05-27 23:39:04] Successfully extracted 58 products using XPath parsing (div[@role="listitem"]).
[2025-05-27 23:39:04] ps_get_user_identifier: User is logged in, wp_user_id = '1'
[2025-05-27 23:39:04] ps_get_user_identifier: Returning logged-in user ID: 'user_1'
[2025-05-27 23:39:04] ps_cache_results: Generated user_id = 'user_1' for query 'thinning hair conditioner'
[2025-05-27 23:39:04] Caching results for user user_1 (query: 'thinning hair conditioner', country: ca): 115.201171875 KB. Items: 60
[2025-05-27 23:39:04] ps_cache_results: About to insert with user_id = 'user_1', query_hash = 'ec25c1f6fe00623f1fff8ba90835478c'
[2025-05-27 23:39:04] ps_cache_results: Insert result = SUCCESS, wpdb->insert_id = 28
[2025-05-27 23:39:04] Successfully cached results with hash: ec25c1f6fe00623f1fff8ba90835478c, User: user_1
[2025-05-27 23:39:04] [UNIT PRICE DEBUG] Unit Price Analysis After Live Search | Data: {"totalItems":58,"itemsWithUnitPrice":57,"percentage":98,"shouldDefaultToUnitPrice":true,"sampleItems":[{"index":0,"title":"HAIR BIOLOGY VOLUME 1 IN 1 SHAMPOO 380 ML...","price":"$14.97","price_value":14.97,"price_per_unit":"$3.94\/100 g","unit":"100 g","price_per_unit_value":3.941,"hasUnitPrice":true},{"index":1,"title":"PURA D&#x27;OR Biotin Original Gold Label Anti-Thi...","price":"$56.99","price_value":56.99,"price_per_unit":"$6.02\/100 ml","unit":"100 ml","price_per_unit_value":6.021,"hasUnitPrice":true},{"index":2,"title":"SEEN Conditioner, Fragrance Free - Non-Comedogenic...","price":"$39.00","price_value":39,"price_per_unit":"$15.33\/100 ml","unit":"100 ml","price_per_unit_value":15.331,"hasUnitPrice":true},{"index":3,"title":"Biolage ColorLast Conditioner | Helps Maintain Col...","price":"$51.00","price_value":51,"price_per_unit":"$5.10\/100 ml","unit":"100 ml","price_per_unit_value":5.101,"hasUnitPrice":true},{"index":4,"title":"Majestic Pure Biotin Conditioner for Hair - Thicke...","price":"$16.99","price_value":16.99,"price_per_unit":"$3.59\/100 ml","unit":"100 ml","price_per_unit_value":3.591,"hasUnitPrice":true},{"index":5,"title":"Nioxin Scalp + Hair Thickening System 2 Conditione...","price":"$32.98","price_value":32.98,"price_per_unit":"$6.60\/100 ml","unit":"100 ml","price_per_unit_value":6.601,"hasUnitPrice":true},{"index":6,"title":"HAIR BIOLOGY VOLUME RINSE-OFF CONDITIONER 380 ML...","price":"$14.97","price_value":14.97,"price_per_unit":"$3.94\/100 ml","unit":"100 ml","price_per_unit_value":3.941,"hasUnitPrice":true},{"index":7,"title":"EverPure Sulfate-Free Anti-Breakage, Thickening, V...","price":"$19.27","price_value":19.27,"price_per_unit":"$7.71\/100 ml","unit":"100 ml","price_per_unit_value":7.711,"hasUnitPrice":true},{"index":8,"title":"Viviscal Gorgeous Growth Densifying Conditioner 25...","price":"$17.43","price_value":17.43,"price_per_unit":"$6.97\/100 ml","unit":"100 ml","price_per_unit_value":6.971,"hasUnitPrice":true},{"index":9,"title":"Rice Water Shampoo and Conditioner, Packed with Bi...","price":"$39.99","price_value":39.99,"price_per_unit":"$16.66\/100 ml","unit":"100 ml","price_per_unit_value":16.661,"hasUnitPrice":true}]}
[2025-05-27 23:39:04] [UNIT PRICE DEBUG] Calculate and Save Default Sorting | Data: {"currentSortValue":"price_per_unit","shouldDefaultToUnitPrice":true,"savedDefaultSort":"price_per_unit","willChangeSorting":false}
[2025-05-27 23:43:33] ps_get_user_identifier: User not logged in or wp_user_id is 0, checking for visitor cookie
[2025-05-27 23:43:33] ps_get_user_identifier: Found existing cookie: 'visitor_8392260647'
[2025-05-27 23:43:33] ps_get_user_identifier: Cookie is valid, returning: 'visitor_8392260647'
[2025-05-27 23:43:33] ps_get_user_identifier: User not logged in or wp_user_id is 0, checking for visitor cookie
[2025-05-27 23:43:33] ps_get_user_identifier: Found existing cookie: 'visitor_8392260647'
[2025-05-27 23:43:33] ps_get_user_identifier: Cookie is valid, returning: 'visitor_8392260647'
[2025-05-27 23:43:33] AJAX Search Request - User: visitor_8392260647, Query: '', Exclude: '', Sort: 'price', Min Rating: '4', Country: 'ca', Filter Cached: true
[2025-05-27 23:43:33] [UNIT PRICE DEBUG] Page Load: Document ready fired, initializing unit price sorting system | Data: {"hasAjaxUrl":true,"hasNonce":true,"userAgent":"Mozilla\/5.0 (Linux; Android 10; K) AppleWebKit\/537.36 (KHTML, like Gecko) Chrome\/136.0.0.0 Mobile Sa"}
[2025-05-27 23:43:33] [UNIT PRICE DEBUG] Debug System Test: logToServer function is working | Data: {"timestamp":"2025-05-27T23:43:35.100Z","testMessage":"This is a test to verify debug logging is functional"}
[2025-05-27 23:43:34] [UNIT PRICE DEBUG] Load Cached Results: Request parameters | Data: {"sortBy":"price","country":"ca"}
[2025-05-27 23:43:34] [UNIT PRICE DEBUG] Load Cached Results: Starting to load cached results on page refresh
[2025-05-27 23:43:34] [UNIT PRICE DEBUG] Apply Saved Default Sorting: No saved preference found | Data: {"hasSortElement":true,"savedDefaultSort":null}
[2025-05-27 23:43:34] [UNIT PRICE DEBUG] Load Cached Results: Received response | Data: {"success":true,"productCount":60,"hasResponseData":true,"hasItems":true}
[2025-05-27 23:43:34] [UNIT PRICE DEBUG] Load Cached Results: Successfully processed and rendered products | Data: {"originalCount":60,"filteredCount":17,"finalCount":17,"sortingChanged":false,"currentSortBy":"price"}
